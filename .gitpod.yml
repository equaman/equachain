image:
  file: .gitpod.Dockerfile

checkoutLocation: "starport"

workspaceLocation: "./starport/docs"

tasks:
  - name: Install Starport
    before: |
      go get golang.org/dl/go1.15
      go1.15 download

    init: |
      # Install Starport
      export VUE_APP_CUSTOM_URL=$(gp url)
      export CHISEL_ADDR=$(gp url 7575)
      (cd /workspace/starport && go install ./...)

    command: |
      export VUE_APP_CUSTOM_URL=$(gp url)
      export CHISEL_ADDR=$(gp url 7575)
      export RPC_ADDRESS=$(gp url 26657):443
      export API_ADDRESS=$(gp url 1317)
      export VUE_APP_API_COSMOS=$API_ADDRESS
      export VUE_APP_API_TENDERMINT=$RPC_ADDRESS
      export VUE_APP_WS_TENDERMINT=${RPC_ADDRESS/https/wss}
      
      echo "export VUE_APP_CUSTOM_URL=$VUE_APP_CUSTOM_URL" >> ~/.bashrc
      echo "export CHISEL_ADDR=$CHISEL_ADDR" >> ~/.bashrc
      echo "export RPC_ADDRESS=$RPC_ADDRESS" >> ~/.bashrc
      echo "export API_ADDRESS=$API_ADDRESS" >> ~/.bashrc
      echo "export VUE_APP_API_COSMOS=$VUE_APP_API_COSMOS" >> ~/.bashrc
      echo "export VUE_APP_API_TENDERMINT=$VUE_APP_API_TENDERMINT" >> ~/.bashrc
      echo "export VUE_APP_WS_TENDERMINT=$VUE_APP_WS_TENDERMINT" >> ~/.bashrc
      cd ./docs

      clear && printf '\e[3J'
      echo -e "

      Welcome to Starport! ðŸ’« The friendly CLI that makes building blockchains easy.

      In the sidebar you can see a list of guides that will help you get started.

      This terminal has the \033[1mstarport\033[0m binary already installed and ready to go.

      "
      
ports:
  - port: 1317
  - port: 26657
  - port: 8080
  - port: 7575 
  - port: 4500 
